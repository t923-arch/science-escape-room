<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSI: å…ƒç´ å¤±ç«Šæ¡ˆ (GitHub Fix)</title>
    
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <style>
        :root {
            --bg-color: #0f0f13;
            --panel-bg: #1a1a20;
            --accent-cyan: #00e5ff;
            --accent-green: #00ff9d;
            --accent-yellow: #ffea00;
            --text-main: #d1d1d1;
            --border-color: #333;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
        }

        #game-wrapper {
            width: 900px;
            max-width: 95vw;
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            height: 90vh;
        }

        header {
            background: #000;
            padding: 15px 20px;
            border-bottom: 2px solid var(--accent-cyan);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        h1 { margin: 0; font-size: 1.2rem; color: var(--accent-cyan); letter-spacing: 1px; }

        #content-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 30px;
            position: relative;
        }

        .scene { display: none; animation: fadeIn 0.5s ease; }
        .scene.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .notebook {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-yellow);
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 0.95rem;
        }
        .notebook h3 { margin-top: 0; color: var(--accent-yellow); }

        .btn {
            background: linear-gradient(135deg, #006064, #0097a7);
            border: none;
            color: white;
            padding: 12px 24px;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 4px;
            transition: 0.2s;
            margin-top: 15px;
            display: inline-block;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,229,255,0.3); }

        input[type="text"], input[type="number"] {
            background: #222;
            border: 1px solid #555;
            color: #fff;
            padding: 8px;
            border-radius: 4px;
            width: 150px;
        }

        .flame-grid { display: flex; gap: 10px; margin-top: 10px; }
        .flame-btn { width: 40px; height: 40px; border-radius: 50%; border: 2px solid #555; cursor: pointer; }
        #flame-display { width: 100px; height: 100px; background: #000; margin: 10px 0; border: 1px solid #444; display: flex; justify-content: center; align-items: center; font-size: 0.8rem; color: #555; text-align: center;}
        
        .dna-gel {
            background: #111;
            border: 2px solid #444;
            display: flex;
            justify-content: space-around;
            padding: 10px;
            height: 200px;
        }
        .lane {
            width: 40px;
            background: #222;
            position: relative;
        }
        .band {
            width: 100%;
            height: 4px;
            background: var(--accent-cyan);
            position: absolute;
            box-shadow: 0 0 5px var(--accent-cyan);
        }

        .hint-toggle {
            color: #666;
            cursor: pointer;
            font-size: 0.9rem;
            text-decoration: underline;
            margin-top: 10px;
        }
        .hint-content { display: none; color: #888; font-size: 0.9rem; margin-top: 5px; }
    </style>
</head>
<body>

<div id="game-wrapper">
    <header>
        <h1>ğŸ§ª CSI: å…ƒç´ å¤±ç«Šæ¡ˆ</h1>
        <div style="font-size: 0.9rem;">æ™‚é–“: <span id="timer">00:00</span></div>
    </header>

    <div id="content-area">
        
        <div id="scene-0" class="scene active">
            <h2>ğŸ“ æ¡ˆä»¶ç·¨è™Ÿ 404ï¼šæ¶ˆå¤±çš„ã€Œé‡å­æ™¶é«”ã€</h2>
            <div class="notebook">
                <h3>[æ¡ˆæƒ…æ‘˜è¦]</h3>
                <p>æ™‚é–“ï¼š2026/01/08 å‡Œæ™¨ 02:00<br>åœ°é»ï¼šä¸­å¤®ç§‘å­¸é¤¨<br>å¤±ç‰©ï¼šæ¥µä¸ç©©å®šçš„èƒ½æºæ ¸å¿ƒã€Œé‡å­æ™¶é«”ã€ã€‚</p>
                <p>è­¦æ–¹å°é–äº†ç¾å ´ï¼Œç™¼ç¾çŠ¯äººéå¸¸è¬¹æ…ï¼Œä½†ä»åœ¨åŒ†å¿™ä¸­ç•™ä¸‹äº†å¾®é‡ç—•è·¡ã€‚ä½œç‚ºé‘‘è­˜ç§‘å­¸å¯¦ç¿’ç”Ÿï¼Œä½ éœ€è¦é‹ç”¨ç‰©ç†ã€åŒ–å­¸ã€ç”Ÿç‰©çŸ¥è­˜ï¼Œåœ¨ 35 åˆ†é˜å…§æ‰¾å‡ºçœŸå‡¶ä¸¦æ‰¾å›æ™¶é«”ã€‚</p>
            </div>
            <button class="btn" onclick="gotoScene(1)">é€²å…¥ç¾å ´ (Scene 1)</button>
        </div>

        <div id="scene-1" class="scene">
            <h2>Scene 1: æ³¥åœŸèˆ‡ç«ç„°</h2>
            <p>åœ¨çª—æ¡†ä¸Šç™¼ç¾äº†ä¸æ˜ç²‰æœ«ã€‚ä½ éœ€è¦é€²è¡Œå…©é …æ¸¬è©¦ä¾†é–å®šä¾†æºã€‚</p>
            
            <div class="notebook">
                <h3>æ¸¬è©¦ A: é…¸é¹¼åæ‡‰</h3>
                <p>æ“ä½œï¼šæ»´å…¥ $0.1\text{M}\ \text{HCl}$ã€‚</p>
                <p>ç¾è±¡ï¼šç”¢ç”Ÿå¤§é‡æ°£æ³¡ã€‚</p>
                <p><strong>æ¨è«–ï¼š</strong> å«æœ‰ç¢³é…¸éˆ£ ($\text{CaCO}_3$)ã€‚</p>
            </div>

            <div class="notebook">
                <h3>æ¸¬è©¦ B: ç„°è‰²è©¦é©— (Flame Test)</h3>
                <p>æ“ä½œï¼šæ²¾å–ç²‰æœ«é€²è¡Œé…’ç²¾ç‡ˆç‡ƒç‡’ã€‚</p>
                <p>è«‹é»æ“Šä¸‹æ–¹å…ƒç´ ï¼Œè§€å¯Ÿç«ç„°é¡è‰²ï¼Œæ‰¾å‡ºèˆ‡ç¾å ´æ¨£æœ¬ (äº®é»ƒè‰²) ç›¸ç¬¦çš„é‡‘å±¬ã€‚</p>
            </div>

            <div class="flame-grid">
                <button class="flame-btn" style="background:#ff3333" onclick="showFlame('Li', 'ç´…è‰²')">Li</button>
                <button class="flame-btn" style="background:#ccaaff" onclick="showFlame('K', 'ç´«è‰²')">K</button>
                <button class="flame-btn" style="background:#ffee00" onclick="showFlame('Na', 'äº®é»ƒè‰²')">Na</button>
                <button class="flame-btn" style="background:#00ff00" onclick="showFlame('Cu', 'ç¶ è‰²')">Cu</button>
                <button class="flame-btn" style="background:#ff8800" onclick="showFlame('Ca', 'ç£šç´…è‰²')">Ca</button>
            </div>
            <div id="flame-display">è«‹é¸æ“‡å…ƒç´ </div>

            <hr style="border-color:#333; margin: 20px 0;">

            <p><strong>[å¯¦é©—å®¤åˆ†å€è¡¨]</strong></p>
            <ul>
                <li>Aå€ (Li): é‹°é›»æ± ç ”ç™¼å®¤</li>
                <li>Bå€ (Na): æµ·æ°´æ·¡åŒ–å¯¦é©—å®¤</li>
                <li>Cå€ (Cu): è¶…å°é«”å¯¦é©—å®¤</li>
            </ul>

            <p>æ ¹æ“šé…¸é¹¼åæ‡‰èˆ‡ç„°è‰²çµæœï¼ŒçŠ¯äººå»éå“ªè£¡ï¼Ÿ</p>
            <select id="ans-1">
                <option value="">é¸æ“‡å€åŸŸ</option>
                <option value="A">Aå€ (é‹°)</option>
                <option value="B">Bå€ (éˆ‰)</option>
                <option value="C">Cå€ (éŠ…)</option>
            </select>
            <button class="btn" onclick="checkScene1()">ç¢ºèªåœ°é»</button>
        </div>

        <div id="scene-2" class="scene">
            <h2>Scene 2: å…‰çš„è·¯å¾‘</h2>
            <p>ä½ ä¾†åˆ°äº† Bå€å¯¦é©—å®¤ã€‚é–€é–æ˜¯ä¸€å€‹å…‰å­¸æ„Ÿæ‡‰è£ç½®ã€‚å¿…é ˆèª¿é…å‡ºæ­£ç¢ºæŠ˜å°„ç‡ ($n$) çš„æ¶²é«”æ³¨å…¥æ§½ä¸­ï¼Œä½¿é›·å°„å…‰ç²¾æº–å°„ä¸­æ„Ÿæ‡‰é»ã€‚</p>
            
            <div class="notebook">
                <h3>[å¯¦é©—æ•¸æ“š]</h3>
                <p>å…¥å°„è§’ ($\theta_1$): $53^\circ$ (ç©ºæ°£ä¸­, $n_1 \approx 1$)</p>
                <p>æŠ˜å°„è§’ ($\theta_2$): $37^\circ$ (æœªçŸ¥æ¶²é«”ä¸­, $n_2$)</p>
                <p><strong>[å…¬å¼æç¤º] å¸ä¹ƒè€³å®šå¾‹ (Snell's Law):</strong></p>
                <p>$$n_1 \cdot \sin\theta_1 = n_2 \cdot \sin\theta_2$$</p>
                <p>å·²çŸ¥: $\sin 53^\circ \approx 0.8$, $\sin 37^\circ \approx 0.6$</p>
            </div>

            <p>è«‹è¨ˆç®—æ¶²é«”æŠ˜å°„ç‡ $n_2$ (å–å°æ•¸é»å¾Œå…©ä½)ï¼š</p>
            <input type="number" id="ans-2" step="0.01" placeholder="ä¾‹å¦‚: 1.50">
            
            <div class="hint-toggle" onclick="toggleHint('hint-2')">ğŸ’¡ è¦ºå¾—å¡ä½äº†ï¼Ÿé»æ­¤é¡¯ç¤ºè¨ˆç®—æç¤º</div>
            <div id="hint-2" class="hint-content">
                $$1 \times 0.8 = n_2 \times 0.6$$
                $$n_2 = \frac{0.8}{0.6} = ?$$
            </div>

            <button class="btn" onclick="checkScene2()">æ³¨å…¥æ¶²é«”</button>
        </div>

        <div id="scene-3" class="scene">
            <h2>Scene 3: è½è¦‹é »ç‡</h2>
            <p>é–€æ‰“é–‹äº†ã€‚ä¿éšªç®±ä¸Šæœ‰ä¸€å€‹è²æ³¢ç”¢ç”Ÿå™¨ã€‚å¯†ç¢¼æ˜¯ä¸€çµ„æ•¸å­—ï¼Œæç¤ºå¯«è‘—ï¼šã€Œç•¶å…©å€‹é »ç‡ç›¸è¿‘çš„è²éŸ³åŒæ™‚æ’­æ”¾ï¼Œæ¯ç§’è½åˆ°çš„å¼·å¼±è®ŠåŒ–æ¬¡æ•¸ (æ‹é ») å³ç‚ºå¯†ç¢¼ã€ã€‚</p>

            <div class="notebook">
                <h3>[è²æ³¢æ•¸æ“š]</h3>
                <p>åŸºæº–éŸ³é » $f_1 = 440 \text{ Hz}$</p>
                <p>ç›®æ¨™éŸ³é » $f_2 = 444 \text{ Hz}$</p>
                <p><strong>å…¬å¼ï¼š</strong> æ‹é »é »ç‡ $f_{beat} = |f_1 - f_2|$</p>
            </div>

            <div style="background: #222; padding: 15px; border-radius: 5px;">
                <p>ç¬¬ä¸€çµ„å¯†ç¢¼ï¼š$f_1 = 440$, $f_2 = 444$ã€‚æ‹é »æ˜¯ï¼Ÿ</p>
                <input type="number" id="beat-1" style="width:50px">
                
                <p>ç¬¬äºŒçµ„å¯†ç¢¼ï¼š$f_1 = 1000$, $f_2 = 1007$ã€‚æ‹é »æ˜¯ï¼Ÿ</p>
                <input type="number" id="beat-2" style="width:50px">

                <p>ç¬¬ä¸‰çµ„å¯†ç¢¼ï¼š$f_1 = 256$, $f_2 = 251$ã€‚æ‹é »æ˜¯ï¼Ÿ</p>
                <input type="number" id="beat-3" style="width:50px">
            </div>

            <button class="btn" onclick="checkScene3()">è¼¸å…¥å¯†ç¢¼</button>
        </div>

        <div id="scene-4" class="scene">
            <h2>Scene 4: é›™é‡é©—è­‰</h2>
            <p>ä¿éšªç®±é–‹å•Ÿï¼Œä½ æ‰¾åˆ°äº†å«Œç–‘çŠ¯éºç•™çš„ç”Ÿç‰©æ¨£æœ¬ã€‚ç‚ºäº†ç¢ºä¿è¬ç„¡ä¸€å¤±ï¼Œå¿…é ˆé€²è¡Œã€Œè¡€å‹å¿«ç¯©ã€èˆ‡ã€ŒDNA å‡è† é›»æ³³ã€é›™é‡æ¯”å°ã€‚</p>

            <div class="notebook">
                <h3>[è­‰æ“š 1: è¡€å‹æ¸¬è©¦]</h3>
                <p>ç¾å ´æ¨£æœ¬å° Anti-A å‡é›†ï¼Œå° Anti-B ç„¡åæ‡‰ã€‚</p>
                <p>æ¨è«–ï¼šç¾å ´æ¨£æœ¬ç‚º <strong>Aå‹</strong> è¡€ã€‚</p>
            </div>

            <div class="notebook">
                <h3>[è­‰æ“š 2: DNA é›»æ³³åœ–]</h3>
                <p>ç¾å ´æ¨£æœ¬çš„ DNA åˆ‡å‰²ç‰‡æ®µé•·åº¦åˆ†ä½ˆå¦‚ä¸‹ã€‚è«‹æ‰¾å‡ºèˆ‡è­‰æ“šå®Œå…¨åŒ¹é…çš„å«Œç–‘äººã€‚</p>
            </div>

            <div class="dna-gel">
                <div class="lane">
                    <div style="color:#fff; text-align:center; font-size:0.8rem">è­‰æ“š</div>
                    <div class="band" style="top: 20px;"></div>
                    <div class="band" style="top: 80px;"></div>
                    <div class="band" style="top: 150px;"></div>
                </div>
                <div class="lane">
                    <div style="color:#666; text-align:center; font-size:0.8rem">S1(Oå‹)</div>
                    <div class="band" style="top: 20px;"></div>
                    <div class="band" style="top: 90px;"></div>
                </div>
                <div class="lane">
                    <div style="color:#666; text-align:center; font-size:0.8rem">S2(Aå‹)</div>
                    <div class="band" style="top: 30px;"></div>
                    <div class="band" style="top: 80px;"></div>
                </div>
                <div class="lane">
                    <div style="color:#666; text-align:center; font-size:0.8rem">S3(Aå‹)</div>
                    <div class="band" style="top: 20px;"></div>
                    <div class="band" style="top: 80px;"></div>
                    <div class="band" style="top: 150px;"></div>
                </div>
            </div>

            <hr>
            <p><strong>[å«Œç–‘äººåå–®]</strong></p>
            <ul>
                <li>S1 (Dr. Strange): Oå‹ï¼Œç‰©ç†å­¸å®¶ã€‚</li>
                <li>S2 (Dr. Banner): Aå‹ï¼ŒåŒ–å­¸å®¶ã€‚</li>
                <li>S3 (Dr. Pym): Aå‹ï¼Œé‡å­åŠ›å­¸å®¶ã€‚</li>
            </ul>

            <p>å…‡æ‰‹æ˜¯èª°ï¼Ÿ</p>
            <select id="ans-4">
                <option value="">-- æŒ‡èªå…‡æ‰‹ --</option>
                <option value="S1">S1</option>
                <option value="S2">S2</option>
                <option value="S3">S3</option>
            </select>
            
            <button class="btn" onclick="checkScene4()">æäº¤çµæ¡ˆå ±å‘Š</button>
        </div>

        <div id="scene-5" class="scene">
            <h2 style="color:var(--accent-green)">ğŸ‰ æ¡ˆä»¶åµç ´ (Case Closed)</h2>
            <div class="notebook">
                <p>æ­å–œï¼ä½ æˆåŠŸæ‰¾å›äº†é‡å­æ™¶é«”ã€‚</p>
                <p>æœ¬æ¬¡è€—æ™‚: <span id="final-time"></span></p>
                <hr>
                <p><strong>å›é¡§é‡é»ï¼š</strong></p>
                <ol>
                    <li>[åŒ–] ç„°è‰²è©¦é©— $Na$ = é»ƒè‰²ã€‚</li>
                    <li>[ç‰©] å¸ä¹ƒè€³å®šå¾‹ $n = \frac{\sin53^\circ}{\sin37^\circ} \approx 1.33$ã€‚</li>
                    <li>[ç‰©] æ‹é »åŸç† $f_{beat} = |f_1 - f_2|$ã€‚</li>
                    <li>[ç”Ÿ] DNA é›»æ³³åœ–è­œçš„å”¯ä¸€æ€§ã€‚</li>
                </ol>
            </div>
            <button class="btn" onclick="location.reload()">é‡æ–°æŒ‘æˆ°</button>
        </div>

    </div>
</div>

<script>
    let startTime = Date.now();
    setInterval(() => {
        let delta = Math.floor((Date.now() - startTime) / 1000);
        let m = Math.floor(delta / 60).toString().padStart(2, '0');
        let s = (delta % 60).toString().padStart(2, '0');
        document.getElementById('timer').innerText = `${m}:${s}`;
    }, 1000);

    function gotoScene(n) {
        document.querySelectorAll('.scene').forEach(el => el.classList.remove('active'));
        document.getElementById('scene-' + n).classList.add('active');
        document.getElementById('content-area').scrollTop = 0;
    }

    function toggleHint(id) {
        let el = document.getElementById(id);
        el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }

    function showFlame(element, colorName) {
        let display = document.getElementById('flame-display');
        display.innerText = `${element} : ${colorName}`;
        display.style.color = colorName === 'äº®é»ƒè‰²' ? '#ffee00' : 
                              colorName === 'ç´…è‰²' ? '#ff3333' : 
                              colorName === 'ç´«è‰²' ? '#ccaaff' :
                              colorName === 'ç¶ è‰²' ? '#00ff00' : '#ff8800';
    }

    function checkScene1() {
        let ans = document.getElementById('ans-1').value;
        if(ans === 'B') {
            alert('æ¨è«–æ­£ç¢ºï¼æ¨£æœ¬å«æœ‰éˆ‰é›¢å­(é»ƒè‰²ç«ç„°)ï¼Œç›®æ¨™é–å®š Bå€å¯¦é©—å®¤ã€‚');
            gotoScene(2);
        } else {
            alert('æ¨è«–éŒ¯èª¤ã€‚æç¤ºï¼šç¾å ´æ¨£æœ¬ç«ç„°ç‚ºã€Œäº®é»ƒè‰²ã€ï¼Œè«‹å°ç…§å…ƒç´ é€±æœŸè¡¨å¸¸è­˜æˆ–æ¸¬è©¦çµæœã€‚');
        }
    }

    function checkScene2() {
        let ans = parseFloat(document.getElementById('ans-2').value);
        if(ans >= 1.32 && ans <= 1.34) {
            alert('æŠ˜å°„ç‡æ­£ç¢ºï¼æ¶²é«”èª¿é…æˆåŠŸï¼Œé›·å°„æ“Šä¸­æ„Ÿæ‡‰é»ã€‚');
            gotoScene(3);
        } else {
            alert('è¨ˆç®—éŒ¯èª¤ã€‚é›·å°„åé›¢ç›®æ¨™ã€‚è«‹æª¢æŸ¥ n = sin(53) / sin(37)ã€‚');
        }
    }

    function checkScene3() {
        let b1 = parseInt(document.getElementById('beat-1').value);
        let b2 = parseInt(document.getElementById('beat-2').value);
        let b3 = parseInt(document.getElementById('beat-3').value);

        if(b1 === 4 && b2 === 7 && b3 === 5) {
            alert('è²ç´‹å¯†ç¢¼æ­£ç¢ºï¼ä¿éšªç®±é–‹å•Ÿã€‚');
            gotoScene(4);
        } else {
            alert('å¯†ç¢¼éŒ¯èª¤ã€‚è¨˜å¾—æ‹é »æ˜¯å…©å€‹é »ç‡çš„å·®å€¼ (çµ•å°å€¼)ã€‚');
        }
    }

    function checkScene4() {
        let ans = document.getElementById('ans-4').value;
        if(ans === 'S3') {
            document.getElementById('final-time').innerText = document.getElementById('timer').innerText;
            gotoScene(5);
        } else if (ans === 'S1') {
            alert('éŒ¯èª¤ã€‚S1 æ˜¯ Oå‹è¡€ï¼Œèˆ‡ç¾å ´ Aå‹è¡€ä¸ç¬¦ (æŠ—åŸæ¸¬è©¦å·²æ’é™¤)ã€‚');
        } else if (ans === 'S2') {
            alert('éŒ¯èª¤ã€‚é›–ç„¶ S2 æ˜¯ Aå‹è¡€ï¼Œä½† DNA é›»æ³³æ¢å¸¶ä½ç½®èˆ‡ç¾å ´è­‰æ“šä¸ç¬¦ã€‚');
        } else {
            alert('è«‹é¸æ“‡ä¸€ä½å«Œç–‘äººã€‚');
        }
    }
</script>

</body>
</html>